package calc;

import static pt.utl.ist.po.ui.UserInteraction.IO;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import calc.core.*;
import pt.utl.ist.po.ui.Menu;

/**
* @author Isabel Costa 76394
* @author InÃªs Garcia 76417
* @author Eliana Silva 76455
*/

public class Calc implements Serializable{
	
	/**
	 * 
	 */
	private static final long serialVersionUID = -6057555101405162927L;
	private FolhaDeCalculo _folhaCalculo = null;
	private boolean isOpen = false;
//	private String _name;
	
//	public Calc(String name){
//		_name = name;
//	}
	
	public boolean isFolOpen(){
		return isOpen;
	}
	public void openFolha(){
		isOpen = true;
	}
	
	public FolhaDeCalculo getFolha(){
		return _folhaCalculo ;
	}

	public void setFolha(int linha, int coluna){
		_folhaCalculo = new FolhaDeCalculo(linha, coluna);

	}
	
	public void setMyFolha(FolhaDeCalculo folha){
		_folhaCalculo = folha;
		
	}
		
	public void loadFolha(String name) throws ClassNotFoundException, IOException {
			try {
				ObjectInputStream in = new ObjectInputStream (new FileInputStream(name));
				_folhaCalculo = (FolhaDeCalculo) in.readObject();
				in.close();
				_folhaCalculo.setName(name);
				openFolha();
			} catch (IOException e) {
			}
		}
	
	public void saveFolha(String name){
		try{
			ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(name));  
			out.writeObject(_folhaCalculo);
			out.close();
		} catch (IOException i){

		}
	}

	public static void main(String args[]){

		Calc app = new Calc();
		/* Read an Import file, if any */
		String filename = System.getProperty("import");
		Parse parser = new Parse();
		if (filename != null) parser.parseFile(filename, app.getFolha());

		 /* Start the user interface with the Bank instance */
		IO.setTitle("");
		Menu m = new AppMenu(app);
		m.open();
		IO.close();



//**************************************************************************************************


		// Bank bank = null;
		// String file = System.getProperty("Save");

		// /* Create a Bank instance */
		// if (args.length == 1) {
		// 	bank = new Bank(args[0]);
		// } else {
		// 	if (file != null)
		// 	  try {
		// 	    bank = Bank.load(file);
		// 	  } catch (Exception e) {
		// 	    System.out.println("Erro : "+file+" : "+e);
		// 	  }
		// 	if (bank == null)
		// 	  bank = new Bank("Banco");
		// }

		// /* Read an Import file, if any */
		// String filename = System.getProperty("Import");
		// if (filename != null) bank.parseInputFile(filename);

		// /* Start the user interface with the Bank instance */
		// IO.setTitle(bank.getName());
		// Menu m = new BankMenu(bank);
		// m.open();

		// /* On end, save file and close IO */
		// if (file != null)
		//   try {
		//      bank.save(file);
		//   } catch (IOException e) {
		//     System.out.println("Erro : "+file+" : "+e);
		//   }
		// IO.close();

//***************************************************************************************************		


	}

}